# Analysis. Toloka Banch

```{r an-tol-opts}
# knitr::opts_chunk$set(eval = FALSE)
```

## Packages

```{r pkgs-analysis}
library(tidyverse)
theme_set(theme_bw()) # set black and white theme
library(lme4)
library(lmerTest)
library(lsmeans)
library(MuMIn)
library(pwr)
library(knitr)
library(effectsize)
```

```{r}
rm(list = ls())
```


## Reading data

```{r reading-data}
MR_data <- read_csv("../preproc-data/MR_tol_data.csv")
ST_data <- read_csv("../preproc-data/ST_tol_data.csv")
MS_data <- read_csv("../preproc-data/MS_tol_data.csv")
NASATLX_data <- read_csv("../preproc-data/NASATLX_tol_data.csv")
SEQUENCE_data <- read_csv("../preproc-data/SEQ_tol_data.csv")
WEIGHTS_data <- read_csv("../preproc-data/WEIGHTS_tol_data.csv")
```



## Behavioral data

### Remove outliers & Aggregate

```{r is-outlier-fun}
is_outlier <- function(x) ifelse(x > quantile(x, .25, na.rm = TRUE) - 1.5 * IQR(x, na.rm = TRUE) &
                                   x < quantile(x, .75, na.rm = TRUE) + 1.5 * IQR(x, na.rm = TRUE),
                                 FALSE, TRUE)
```

#### Mental Rotation

```{r}
MR_data |> 
  group_by(id, level, task) |> 
  mutate(is_outlier = is_outlier(rt)) |> 
  filter(!is_outlier) |> 
  summarise(rt = mean(rt),
            acc = mean(is_correct)) -> MR_data_agg
```

```{r, eval=FALSE}
MR_data_agg |> write_csv("../preproc-data/MR_tol_data_agg.csv")
```

```{r, echo=FALSE, message=FALSE}
MR_data_agg <- read_csv("../preproc-data/MR_tol_data_agg.csv")
```

#### Memory Span

```{r ms-agg}
MS_data |> 
  group_by(id, level, task) |> 
  mutate(is_outlier = is_outlier(rt)) |> 
  filter(!is_outlier) |> 
  summarise(rt = mean(rt),
            acc = mean(acc)) -> MS_data_agg
```

```{r, eval=FALSE}
MS_data_agg |> write_csv("../preproc-data/MS_tol_data_agg.csv")
```

```{r, echo=FALSE, message=FALSE}
MS_data_agg <- read_csv("../preproc-data/MS_tol_data_agg.csv")
```

#### Sternberg Task

```{r st-agg}
ST_data |> 
  group_by(id, level, task) |> 
  mutate(is_outlier = is_outlier(rt)) |> 
  filter(!is_outlier) |> 
  summarise(rt = mean(rt),
            acc = mean(is_correct)) -> ST_data_agg
```

```{r, eval=FALSE}
ST_data_agg |> write_csv("../preproc-data/ST_tol_data_agg.csv")
```

```{r, echo=FALSE, message=FALSE}
ST_data_agg <- read_csv("../preproc-data/ST_tol_data_agg.csv")
```

```{r}
MR_data_agg |> summarise(range = range(rt))
MS_data_agg |> summarise(range = range(rt, na.rm = TRUE))
ST_data_agg |> summarise(range = range(rt))
```

### Plot all paradigms

```{r rt_plot, warning=FALSE}
MR_data_agg |> 
  bind_rows(MS_data_agg, ST_data_agg) |>
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, rt)) +
  facet_wrap(~ task, scales = "free_y", 
             labeller = labeller(task = c(MR = "Mental Rotation",
                                          MS = "Memory Span", 
                                          ST = "Sternberg Task"))) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s")
```

```{r acc_plot}
MR_data_agg |> 
  bind_rows(MS_data_agg, ST_data_agg) |>
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, acc)) +
  facet_wrap(~ task, scales = "free_y", 
             labeller = labeller(task = c(MR = "Mental Rotation",
                                          MS = "Memory Span", 
                                          ST = "Sternberg Task"))) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Accuracy")
```

### Desriptives

#### Mental Rotation 

```{r mr_rt_desc}
MR_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(rt),
            median = median(rt),
            sd = sd(rt),
            min = min(rt),
            max = max(rt),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  # mutate_all(.funs = function(x) if (is.double(x)) return(round(x, 2)) else return(x)) |> 
  knitr::kable(caption = "Mental Rotation. Reaction Time", digits = 2)
```

```{r mr_acc_desc}
MR_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(acc),
            sd = sd(acc),
            min = min(acc),
            max = max(acc),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  # mutate_all(.funs = function(x) if (is.double(x)) return(round(x, 3)) else return(x)) |> 
  knitr::kable(caption = "Mental Rotation. Accuracy", digits = 3)
```


#### Memory Span

```{r ms_rt_desc}
MS_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(rt, na.rm = TRUE),
            median = median(rt, na.rm = TRUE),
            sd = sd(rt, na.rm = TRUE),
            min = min(rt, na.rm = TRUE),
            max = max(rt, na.rm = TRUE),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  # mutate_all(.funs = function(x) if (is.double(x)) return(round(x, 2)) else return(x)) |> 
  knitr::kable(caption = "Memory Span. Reaction Time", digits = 2)
```

```{r ms_acc_desc}
MS_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(acc),
            sd = sd(acc),
            min = min(acc),
            max = max(acc),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  knitr::kable(caption = "Memory Span. Accuracy", digits = 3)
```


#### Sternberg Task

```{r st_rt_desc}
ST_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(rt),
            sd = sd(rt),
            min = min(rt),
            max = max(rt),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  knitr::kable(caption = "Sternberg Task. Reaction Time", digits = 2)
```

```{r st_acc_desc}
ST_data_agg |> 
  group_by(level, task) |> 
  summarise(n = unique(id) |> length(),
            mean = mean(acc),
            sd = sd(acc),
            min = min(acc),
            max = max(acc),
            CI_lower = mean - 1.96 * sd / sqrt(n),
            CI_upper = mean + 1.96 * sd / sqrt(n)) |> 
  knitr::kable(caption = "Sternberg Task. Accuracy", digits = 3)
```


### ANOVA

```{r bind-data}
MR_data_agg |> 
  bind_rows(MS_data_agg, ST_data_agg) -> all_tol_data_agg
```

#### Reaction Time

```{r rt-anova}
mix_rt <- lmer(rt ~ task * level + (1|id), all_tol_data_agg)
summary(mix_rt)
anova(mix_rt)
```

```{r pairwise-rt}
lsmeans(mix_rt, pairwise ~ task:level, adjust = "tukey")
```

```{r rt_plot_, warning=FALSE}
MR_data_agg |> 
  bind_rows(MS_data_agg, ST_data_agg) |>
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, rt)) +
  facet_wrap(~ task, scales = "free_y", 
             labeller = labeller(task = c(MR = "Mental Rotation",
                                          MS = "Memory Span", 
                                          ST = "Sternberg Task"))) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s")
```

#### Accuracy

```{r acc-anova}
mix_acc <- lmer(acc ~ task * level + (1|id), all_tol_data_agg)
summary(mix_acc)
anova(mix_acc)
```

```{r pairwise-acc}
lsmeans(mix_acc, pairwise ~ task:level, adjust = "tukey")
```

```{r acc_plot_}
MR_data_agg |> 
  bind_rows(MS_data_agg, ST_data_agg) |>
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, acc)) +
  facet_wrap(~ task, scales = "free_y", 
             labeller = labeller(task = c(MR = "Mental Rotation",
                                          MS = "Memory Span", 
                                          ST = "Sternberg Task"))) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Accuracy")
```



## Questionnaire Data

```{r nasa-fix-factor}
NASATLX_data |> 
  # fix factor
  mutate(
    level = factor(
      level,
      levels = c("easy", "medium", "hard"),
      ordered = TRUE
    )
  ) -> NASATLX_data
```

```{r set-colors}
level_colors <- c("#4bd752", "#d7984b", "#d7524b")
task_colors <- c("red4", "green4", "blue4")
back_histogram_color <- "gray60"
```


### Weighted Scales

```{r}
WEIGHTS_data |> 
  rename("scale" = choice,
         "task" = task_type) |> 
  mutate(task = recode(task,
                       "mental_rotation" = "MR",
                       "sternberg" = "ST",
                       "mental_span" = "MS")) |> 
  full_join(NASATLX_data,
            by = join_by(id, task, scale)) |> 
  select(-pool.x) |> 
  rename("pool" = pool.y) |> 
  mutate(n = ifelse(is.na(n), 0, n),
         w = ifelse(is.na(w), 0, w)) |> 
  mutate(score_w = w * score,
         scale_w = paste0(scale, "_w")) |> 
  select(id, task, level, scale_w, score_w) |> 
  pivot_wider(values_from = score_w, names_from = scale_w) |> 
  mutate(OW_w = ME_w + PH_w + TI_w + PE_w + EF_w + FR_w) -> nasa_tlx_weighted_wide
  
nasa_tlx_weighted_wide |> 
    pivot_longer(cols = -c("id", "task", "level"),
               names_to = "scale_w", values_to = "score_w") -> NASATLX_weighted

nasa_tlx_weighted_wide |> 
    full_join(
      NASATLX_data |> 
        pivot_wider(values_from = score, names_from = scale) |> 
        mutate(OW = ME + PH + TI + PE + EF + FR),
      by = join_by(id, task, level)
      ) -> NASATLX
```


#### Plot Score Distribution

```{r}
NASATLX_weighted |>
  filter(scale_w != "OW_w") |> 
  ggplot(aes(scale_w, score_w, fill = level)) +
  geom_boxplot() +
  facet_grid(task ~ .,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_fill_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions by Scale")
```

```{r}
NASATLX_weighted |>
  filter(scale_w == "OW_w") |> 
  ggplot(aes(scale_w, score_w, fill = level)) +
  geom_boxplot() +
  facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_fill_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Overall Score Distributions by Scale")
```


```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w != "OW_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(task ~ .,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  scale_x_discrete(labels = c(
    EF_w = "EF",
    FR_w = "FR",
    ME_w = "ME",
    PE_w = "PE",
    PH_w = "PH",
    TI_w = "TI"
  )) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       color = "Difficulty Level",
       #title = "Weighted Score Distributions by Scale"
       )
ggsave("weighted_scales.png",
                   width = 20,
                   height = 15,
                   units = "cm")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "OW_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Overall Score Distributions by Scale")
```


```{r}
NASATLX |>
  pivot_longer(cols = -c("id", "task", "level", "pool"),
               names_to = "scale", values_to = "score") |> 
  filter(str_detect(scale, "_w")) |> 
  rename("score_w" = score) |> 
  mutate(scale = str_remove_all(scale, "_w")) |> 
  full_join(
    NASATLX |> 
      pivot_longer(cols = -c("id", "task", "level", "pool"),
                   names_to = "scale", values_to = "score") |> 
      filter(!str_detect(scale, "_w")),
    by = join_by("id", "task", "level", "scale", "pool")
  ) |> 
  mutate(level = factor(level, ordered = TRUE,
                        levels = c("easy", "medium", "hard"))) -> nasatlx
```

```{r, eval=FALSE}
nasatlx |> write_csv("../preproc-data/nasatlx_weighted&raw_score_tol_data.csv")
```


#### Correlations between Weighted and Raw Score

```{r}
nasatlx |> 
  filter(scale != "OW") |> 
  ggplot(aes(score, score_w, color = level)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_grid(task ~ scale) +
  scale_color_manual(values = level_colors) +
  theme(legend.position = "bottom")
```

```{r}
nasatlx |> 
  filter(scale == "OW") |> 
  ggplot(aes(score, score_w, color = level)) +
  geom_point(alpha = .3) +
  geom_smooth(method = "lm") +
  facet_grid(task ~ scale) +
  scale_color_manual(values = level_colors) +
  theme(legend.position = "bottom")
```

```{r}
nasatlx |> 
  group_by(task, level, scale) |> 
  summarise(cor = cor(score, score_w)) |> 
  arrange(desc(cor)) |> 
  knitr::kable(caption = "Correlations between raw and weighted scores",
               digits = 2)
```


```{r, include=FALSE}
pd <- position_dodge(0.3)
NASATLX_data |>
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  facet_grid(task ~ .) +
  theme(legend.position = "bottom") +
  labs(x = "Шкалы NASA-TLX",
       y = "NASA-TLX (сырой балл)",
       color = "Уровень сложности") +
  scale_color_manual(values = level_colors, 
                     labels = c(easy = "легкий", 
                                medium = "средний", 
                                hard = "сложный"))
ggsave("anova_errorbars_color.png", dpi = 300)
```

```{r, include=FALSE}
pd <- position_dodge(0.3)
NASATLX_data |>
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  facet_grid(task ~ .) +
  theme(legend.position = "bottom") +
  labs(x = "Шкалы NASA-TLX",
       y = "NASA-TLX (сырой балл)",
       color = "Уровень сложности") +
  scale_color_manual(values = c(easy = "black",
                                medium = "gray40",
                                hard = "gray60"))
ggsave("anova_errorbars.png", dpi = 300)
```


#### Comparison of Weighted and Raw Score

```{r}
pd <- position_dodge(0.3)
nasatlx |>
  pivot_longer(cols = c("score", "score_w"),
               names_to = "type", values_to = "score") |> 
  mutate(type = recode(type,
                       "score" = "raw",
                       "score_w" = "weighted")) |> 
  filter(scale != "OW") |> 
  ggplot(aes(scale, score, color = level, shape = type)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  facet_grid(type ~ task,
             scales = "free_y",
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  guides(type = "none") +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted & Raw Score Distributions by Scale")
```

```{r}
pd <- position_dodge(0.3)
nasatlx |>
  pivot_longer(cols = c("score", "score_w"),
               names_to = "type", values_to = "score") |> 
  mutate(type = recode(type,
                       "score" = "raw",
                       "score_w" = "weighted")) |> 
  filter(scale == "OW") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  facet_grid(type ~ task,
             scales = "free_y",
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  guides(shape = "none") +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted & Raw Overall Score Distributions by Scale")

nasatlx |>
  pivot_longer(cols = c("score", "score_w"),
               names_to = "type", values_to = "score") |> 
  mutate(type = recode(type,
                       "score" = "raw",
                       "score_w" = "weighted")) |> 
  filter(scale == "OW") |> 
  ggplot(aes(scale, score, color = level, shape = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(type ~ task,
              scales = "free_y",
             labeller = labeller(
               task = c(
                 MR = "Mental Rotation",
                 MS = "Memory Span",
                 ST = "Sternberg Task"
                 ),
               type = c(
                 raw = "Raw",
                 weighted = "Weighted"
               ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  scale_x_discrete(labels = NULL) +
  labs(x = "Overall Workload (OW)",
       y = "NASA-TLX Score",
       color = "Difficulty Level",
       shape = "Difficulty Level")
```

### GLMM weighted scales

```{r}
NASATLX_data |> 
  pivot_wider(values_from = score, names_from = scale) |> 
  mutate(OW = ME + PH + TI + PE + EF + FR) -> nasa_tlx_wide

```

```{r, eval=FALSE}
nasa_tlx_weighted_wide |> write_csv("../preproc-data/nasatlx_weighted_score_tol_data.csv")
nasa_tlx_wide |> write_csv("../preproc-data/nasatlx_raw_score_tol_data.csv")
```

```{r r2-to-f2, include=FALSE}
r2tof2 <- function(r2) r2 / (1 - r2)
```

#### ME

##### Weigted
```{r mix-me-w}
mix_ME_w <- lmer(ME_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_ME_w)
anova(mix_ME_w)
r.squaredGLMM(mix_ME_w)[1]
```

```{r pairwise-me-w}
lsmeans(mix_ME_w, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "ME_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Mental Demand")
```

##### Raw
```{r mix-me}
mix_ME <- lmer(ME ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_ME)
anova(mix_ME)
r.squaredGLMM(mix_ME)[1]
```

```{r pairwise-me}
lsmeans(mix_ME, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Mental Demand")
```


#### PH

##### Weighted
```{r mix-ph-w}
mix_PH_w <- lmer(PH_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_PH_w)
anova(mix_PH_w)
r.squaredGLMM(mix_PH_w)[1]
```

```{r pairwise-ph-w}
lsmeans(mix_PH_w, pairwise ~ level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "PH_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Physical Demand")
```

##### Raw
```{r mix-ph}
mix_PH <- lmer(PH ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_PH)
anova(mix_PH)
r.squaredGLMM(mix_PH)[1]
```

```{r pairwise-ph}
lsmeans(mix_PH, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Physical Demand")
```


#### TI

##### Weighted
```{r mix-ti-w}
mix_TI_w <- lmer(TI_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_TI_w)
anova(mix_TI_w)
r.squaredGLMM(mix_TI_w)[1]
```

```{r pairwise-ti-w}
lsmeans(mix_ME, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "TI_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Time Pressure")
```

##### Raw
```{r mix-ti}
mix_TI <- lmer(TI ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_TI)
anova(mix_TI)
r.squaredGLMM(mix_TI)[1]
```

```{r pairwise-ti}
lsmeans(mix_TI, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Time Pressure")
```

#### PE

##### Weighted
```{r mix-pe-w}
mix_PE_w <- lmer(PE_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_PE_w)
anova(mix_PE_w)
r.squaredGLMM(mix_PE_w)[1]
```

```{r pairwise-pe-w}
lsmeans(mix_PE_w, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "PE_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Performance")
```

##### Raw
```{r mix-pe}
mix_PE <- lmer(PE ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_PE)
anova(mix_PE)
r.squaredGLMM(mix_PE)[1]
```

```{r pairwise-pe}
lsmeans(mix_PE, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Performance")
```


#### EF

##### Weighted
```{r mix-ef-w}
mix_EF_w <- lmer(EF_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_EF_w)
anova(mix_EF_w)
r.squaredGLMM(mix_EF_w)[1]
```

```{r pairwise-ef-w}
lsmeans(mix_EF_w, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "EF_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Effort")
```

##### Raw
```{r mix-ef}
mix_EF <- lmer(EF ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_EF)
anova(mix_EF)
r.squaredGLMM(mix_EF)[1]
```

```{r pairwise-ef}
lsmeans(mix_EF, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Effort")
```

#### FR

##### Weighted
```{r mix-fr-w}
mix_FR_w <- lmer(FR_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_FR_w)
anova(mix_FR_w)
r.squaredGLMM(mix_FR_w)[1]
```

```{r pairwise-fr-w}
lsmeans(mix_FR_w, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "FR_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Frustration")
```

##### Raw
```{r mix-fr}
mix_FR <- lmer(FR ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_FR)
anova(mix_FR)
r.squaredGLMM(mix_FR)[1]
```

```{r}
lsmeans(mix_FR, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Frustration")
```


#### Overall Workload

##### Weighted
```{r mix-ow-w}
mix_OW_w <- lmer(OW_w ~ task * level + (1|id), 
               nasa_tlx_weighted_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_OW_w)
anova(mix_OW_w)
r.squaredGLMM(mix_OW_w)[1]
```

```{r pairwise-ow-w}
lsmeans(mix_OW_w, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
NASATLX_weighted |>
  filter(scale_w == "OW_w") |> 
  ggplot(aes(scale_w, score_w, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Overall Workload")
```


##### Raw
```{r mix-ow}
mix_OW <- lmer(OW ~ task * level + (1|id), 
               nasa_tlx_wide,
               contrasts = list(level="contr.treatment"))
summary(mix_OW)
anova(mix_OW)
r.squaredGLMM(mix_OW)[1]
```

```{r pairwise-ow}
lsmeans(mix_OW, pairwise ~ task:level, adjust = "tukey")
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
   facet_grid(. ~ task,
             labeller = labeller(task = c(
               MR = "Mental Rotation",
               MS = "Memory Span",
               ST = "Sternberg Task"
             ))) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Weighted Score Distributions. Overall Workload")
```





## By Tasks

### Mental Rotation

#### Reaction time

```{r mix-mr-rt}
mix_mr_rt <- lmer(rt ~ level + (1|id), MR_data_agg)
summary(mix_mr_rt)
r.squaredGLMM(mix_mr_rt)
anova(mix_mr_rt)
eta_squared(anova(mix_mr_rt))
```

```{r pairwise-mr-rt}
pairwise_mr_rt <- lsmeans(mix_mr_rt, pairwise ~ level, adjust = "tukey")
pairwise_mr_rt$lsmeans |> as_tibble() |> kable()
pairwise_mr_rt$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
MR_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, rt)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Reaction time. Mental Rotation.")
```


#### Accuracy

```{r mix-mr-acc}
mix_mr_acc <- lmer(acc ~ level + (1|id), MR_data_agg)
summary(mix_mr_acc)
r.squaredGLMM(mix_mr_acc)
anova(mix_mr_acc)
eta_squared(anova(mix_mr_acc))
```

```{r pairwise-mr-acc}
pairwise_mr_acc <- lsmeans(mix_mr_acc, pairwise ~ level, adjust = "tukey")
pairwise_mr_acc$lsmeans |> as_tibble() |> kable()
pairwise_mr_acc$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
MR_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, acc)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Accuracy. Mental Rotation.")
```



#### ME

##### Raw

```{r mix-mr-me}
mix_mr_me <- lmer(ME ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_me)
r.squaredGLMM(mix_mr_me)
anova(mix_mr_me)
eta_squared(anova(mix_mr_me))
```

```{r pairwise-mr-me}
pairwise_mr_me <- lsmeans(mix_mr_me, pairwise ~ level, adjust = "tukey")
pairwise_mr_me$lsmeans |> as_tibble() |> kable()
pairwise_mr_me$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Mental Demand")
```

##### Weighted

```{r mix-mr-me-w}
mix_mr_me_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_me_w)
r.squaredGLMM(mix_mr_me_w)
anova(mix_mr_me_w)
eta_squared(anova(mix_mr_me_w))
```

```{r pairwise-mr-me-w}
pairwise_mr_me_w <- lsmeans(mix_mr_me_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_me_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_me_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Mental Demand")
```



#### PH

##### Raw

```{r mix-mr-ph}
mix_mr_ph <- lmer(PH ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_ph)
r.squaredGLMM(mix_mr_ph)
anova(mix_mr_ph)
eta_squared(anova(mix_mr_ph))
```

```{r pairwise-mr-ph}
pairwise_mr_ph <- lsmeans(mix_mr_ph, pairwise ~ level, adjust = "tukey")
pairwise_mr_ph$lsmeans |> as_tibble() |> kable()
pairwise_mr_ph$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Physical Demand")
```

##### Weighted

```{r mix-mr-ph-w}
mix_mr_ph_w <- lmer(PH_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_ph_w)
r.squaredGLMM(mix_mr_ph_w)
anova(mix_mr_ph_w)
eta_squared(anova(mix_mr_ph_w))
```

```{r pairwise-mr-ph-w}
pairwise_mr_ph_w <- lsmeans(mix_mr_ph_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_ph_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_ph_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Physical Demand")
```



#### TI

##### Raw

```{r mix-mr-ti}
mix_mr_ti <- lmer(TI ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_ti)
r.squaredGLMM(mix_mr_ti)
anova(mix_mr_ti)
eta_squared(anova(mix_mr_ti))
```

```{r pairwise-mr-ti}
pairwise_mr_ti <- lsmeans(mix_mr_ti, pairwise ~ level, adjust = "tukey")
pairwise_mr_ti$lsmeans |> as_tibble() |> kable()
pairwise_mr_ti$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Time Pressure")
```

##### Weighted

```{r mix-mr-ti-w}
mix_mr_ti_w <- lmer(TI_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_ti_w)
r.squaredGLMM(mix_mr_ti_w)
anova(mix_mr_ti_w)
eta_squared(anova(mix_mr_ti_w))
```

```{r pairwise-mr-ti-w}
pairwise_mr_ti_w <- lsmeans(mix_mr_ti_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_ti_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_ti_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Time Pressure")
```




#### PE

##### Raw

```{r mix-mr-pe}
mix_mr_pe <- lmer(PE ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_pe)
r.squaredGLMM(mix_mr_pe)
anova(mix_mr_pe)
eta_squared(anova(mix_mr_pe))
```

```{r pairwise-mr-pe}
pairwise_mr_pe <- lsmeans(mix_mr_pe, pairwise ~ level, adjust = "tukey")
pairwise_mr_pe$lsmeans |> as_tibble() |> kable()
pairwise_mr_pe$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Performance")
```

##### Weighted

```{r mix-mr-pe-w}
mix_mr_pe_w <- lmer(PE_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_pe_w)
r.squaredGLMM(mix_mr_pe_w)
anova(mix_mr_pe_w)
eta_squared(anova(mix_mr_pe_w))
```

```{r pairwise-mr-pe-w}
pairwise_mr_pe_w <- lsmeans(mix_mr_pe_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_pe_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_pe_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Performance")
```



#### EF

##### Raw

```{r mix-mr-ef}
mix_mr_ef <- lmer(EF ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_ef)
r.squaredGLMM(mix_mr_ef)
anova(mix_mr_ef)
eta_squared(anova(mix_mr_ef))
```

```{r pairwise-mr-ef}
pairwise_mr_ef <- lsmeans(mix_mr_ef, pairwise ~ level, adjust = "tukey")
pairwise_mr_ef$lsmeans |> as_tibble() |> kable()
pairwise_mr_ef$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Effort")
```

##### Weighted

```{r mix-mr-ef-w}
mix_mr_ef_w <- lmer(EF_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_ef_w)
r.squaredGLMM(mix_mr_ef_w)
anova(mix_mr_ef_w)
eta_squared(anova(mix_mr_ef_w))
```

```{r pairwise-mr-ef-w}
pairwise_mr_ef_w <- lsmeans(mix_mr_ef_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_ef_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_ef_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Effort")
```


#### FR

##### Raw

```{r mix-mr-fr}
mix_mr_fr <- lmer(FR ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_fr)
r.squaredGLMM(mix_mr_fr)
anova(mix_mr_fr)
eta_squared(anova(mix_mr_fr))
```

```{r pairwise-mr-fr}
pairwise_mr_fr <- lsmeans(mix_mr_fr, pairwise ~ level, adjust = "tukey")
pairwise_mr_fr$lsmeans |> as_tibble() |> kable()
pairwise_mr_fr$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Frustration")
```

##### Weighted

```{r mix-mr-fr-w}
mix_mr_fr_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_fr_w)
r.squaredGLMM(mix_mr_fr_w)
anova(mix_mr_fr_w)
eta_squared(anova(mix_mr_fr_w))
```

```{r pairwise-mr-fr-w}
pairwise_mr_fr_w <- lsmeans(mix_mr_fr_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_fr_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_fr_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Frustration")
```


#### OW

##### Raw

```{r mix-mr-ow}
mix_mr_ow <- lmer(OW ~ level + (1|id), nasa_tlx_wide |> filter(task == "MR"))
summary(mix_mr_ow)
r.squaredGLMM(mix_mr_ow)
anova(mix_mr_ow)
eta_squared(anova(mix_mr_ow))
```

```{r pairwise-mr-ow}
pairwise_mr_ow <- lsmeans(mix_mr_ow, pairwise ~ level, adjust = "tukey")
pairwise_mr_ow$lsmeans |> as_tibble() |> kable()
pairwise_mr_ow$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Mental Rotation. Overall Workload")
```

##### Weighted

```{r mix-mr-ow-w}
mix_mr_ow_w <- lmer(OW_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MR"))
summary(mix_mr_ow_w)
r.squaredGLMM(mix_mr_ow_w)
anova(mix_mr_ow_w)
eta_squared(anova(mix_mr_ow_w))
```

```{r pairwise-mr-ow-w}
pairwise_mr_ow_w <- lsmeans(mix_mr_ow_w, pairwise ~ level, adjust = "tukey")
pairwise_mr_ow_w$lsmeans |> as_tibble() |> kable()
pairwise_mr_ow_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW_w" & task == "MR") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Mental Rotation. Overall Workload")
```



### Memory Span

#### Reaction time

```{r mix-ms-rt}
mix_ms_rt <- lmer(rt ~ level + (1|id), MS_data_agg)
summary(mix_ms_rt)
r.squaredGLMM(mix_ms_rt)
anova(mix_ms_rt)
eta_squared(anova(mix_ms_rt))
```

```{r pairwise-ms-rt}
pairwise_ms_rt <- lsmeans(mix_ms_rt, pairwise ~ level, adjust = "tukey")
pairwise_ms_rt$lsmeans |> as_tibble() |> kable()
pairwise_ms_rt$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
MS_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, rt)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Reaction time. Memory Span.")
```


#### Accuracy

```{r mix-ms-acc}
mix_ms_acc <- lmer(acc ~ level + (1|id), MS_data_agg)
summary(mix_ms_acc)
r.squaredGLMM(mix_ms_acc)
anova(mix_ms_acc)
eta_squared(anova(mix_ms_acc))
```

```{r pairwise-ms-acc}
pairwise_ms_acc <- lsmeans(mix_ms_acc, pairwise ~ level, adjust = "tukey")
pairwise_ms_acc$lsmeans |> as_tibble() |> kable()
pairwise_ms_acc$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
MS_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, acc)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Accuracy. Memory Span.")
```



#### ME

##### Raw

```{r mix-ms-me}
mix_ms_me <- lmer(ME ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_me)
r.squaredGLMM(mix_ms_me)
anova(mix_ms_me)
eta_squared(anova(mix_ms_me))
```

```{r pairwise-ms-me}
pairwise_ms_me <- lsmeans(mix_ms_me, pairwise ~ level, adjust = "tukey")
pairwise_ms_me$lsmeans |> as_tibble() |> kable()
pairwise_ms_me$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Mental Demand")
```

##### Weighted

```{r mix-ms-me-w}
mix_ms_me_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_me_w)
r.squaredGLMM(mix_ms_me_w)
anova(mix_ms_me_w)
eta_squared(anova(mix_ms_me_w))
```

```{r pairwise-ms-me-w}
pairwise_ms_me_w <- lsmeans(mix_ms_me_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_me_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_me_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Mental Demand")
```



#### PH

##### Raw

```{r mix-ms-ph}
mix_ms_ph <- lmer(PH ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_ph)
r.squaredGLMM(mix_ms_ph)
anova(mix_ms_ph)
eta_squared(anova(mix_ms_ph))
```

```{r pairwise-ms-ph}
pairwise_ms_ph <- lsmeans(mix_ms_ph, pairwise ~ level, adjust = "tukey")
pairwise_ms_ph$lsmeans |> as_tibble() |> kable()
pairwise_ms_ph$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Physical Demand")
```

##### Weighted

```{r mix-ms-ph-w}
mix_ms_ph_w <- lmer(PH_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_ph_w)
r.squaredGLMM(mix_ms_ph_w)
anova(mix_ms_ph_w)
eta_squared(anova(mix_ms_ph_w))
```

```{r pairwise-ms-ph-w}
pairwise_ms_ph_w <- lsmeans(mix_ms_ph_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_ph_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_ph_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Physical Demand")
```



#### TI

##### Raw

```{r mix-ms-ti}
mix_ms_ti <- lmer(TI ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_ti)
r.squaredGLMM(mix_ms_ti)
anova(mix_ms_ti)
eta_squared(anova(mix_ms_ti))
```

```{r pairwise-ms-ti}
pairwise_ms_ti <- lsmeans(mix_ms_ti, pairwise ~ level, adjust = "tukey")
pairwise_ms_ti$lsmeans |> as_tibble() |> kable()
pairwise_ms_ti$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Time Pressure")
```

##### Weighted

```{r mix-ms-ti-w}
mix_ms_ti_w <- lmer(TI_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_ti_w)
r.squaredGLMM(mix_ms_ti_w)
anova(mix_ms_ti_w)
eta_squared(anova(mix_ms_ti_w))
```

```{r pairwise-ms-ti-w}
pairwise_ms_ti_w <- lsmeans(mix_ms_ti_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_ti_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_ti_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Time Pressure")
```




#### PE

##### Raw

```{r mix-ms-pe}
mix_ms_pe <- lmer(PE ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_pe)
r.squaredGLMM(mix_ms_pe)
anova(mix_ms_pe)
eta_squared(anova(mix_ms_pe))
```

```{r pairwise-ms-pe}
pairwise_ms_pe <- lsmeans(mix_ms_pe, pairwise ~ level, adjust = "tukey")
pairwise_ms_pe$lsmeans |> as_tibble() |> kable()
pairwise_ms_pe$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Performance")
```

##### Weighted

```{r mix-ms-pe-w}
mix_ms_pe_w <- lmer(PE_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_pe_w)
r.squaredGLMM(mix_ms_pe_w)
anova(mix_ms_pe_w)
eta_squared(anova(mix_ms_pe_w))
```

```{r pairwise-ms-pe-w}
pairwise_ms_pe_w <- lsmeans(mix_ms_pe_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_pe_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_pe_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Performance")
```



#### EF

##### Raw

```{r mix-ms-ef}
mix_ms_ef <- lmer(EF ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_ef)
r.squaredGLMM(mix_ms_ef)
anova(mix_ms_ef)
eta_squared(anova(mix_ms_ef))
```

```{r pairwise-ms-ef}
pairwise_ms_ef <- lsmeans(mix_ms_ef, pairwise ~ level, adjust = "tukey")
pairwise_ms_ef$lsmeans |> as_tibble() |> kable()
pairwise_ms_ef$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Effort")
```

##### Weighted

```{r mix-ms-ef-w}
mix_ms_ef_w <- lmer(EF_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_ef_w)
r.squaredGLMM(mix_ms_ef_w)
anova(mix_ms_ef_w)
eta_squared(anova(mix_ms_ef_w))
```

```{r pairwise-ms-ef-w}
pairwise_ms_ef_w <- lsmeans(mix_ms_ef_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_ef_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_ef_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Effort")
```


#### FR

##### Raw

```{r mix-ms-fr}
mix_ms_fr <- lmer(FR ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_fr)
r.squaredGLMM(mix_ms_fr)
anova(mix_ms_fr)
eta_squared(anova(mix_ms_fr))
```

```{r pairwise-ms-fr}
pairwise_ms_fr <- lsmeans(mix_ms_fr, pairwise ~ level, adjust = "tukey")
pairwise_ms_fr$lsmeans |> as_tibble() |> kable()
pairwise_ms_fr$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Frustration")
```

##### Weighted

```{r mix-ms-fr-w}
mix_ms_fr_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_fr_w)
r.squaredGLMM(mix_ms_fr_w)
anova(mix_ms_fr_w)
eta_squared(anova(mix_ms_fr_w))
```

```{r pairwise-ms-fr-w}
pairwise_ms_fr_w <- lsmeans(mix_ms_fr_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_fr_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_fr_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Frustration")
```


#### OW

##### Raw

```{r mix-ms-ow}
mix_ms_ow <- lmer(OW ~ level + (1|id), nasa_tlx_wide |> filter(task == "MS"))
summary(mix_ms_ow)
r.squaredGLMM(mix_ms_ow)
anova(mix_ms_ow)
eta_squared(anova(mix_ms_ow))
```

```{r pairwise-ms-ow}
pairwise_ms_ow <- lsmeans(mix_ms_ow, pairwise ~ level, adjust = "tukey")
pairwise_ms_ow$lsmeans |> as_tibble() |> kable()
pairwise_ms_ow$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Memory Span. Overall Workload")
```

##### Weighted

```{r mix-ms-ow-w}
mix_ms_ow_w <- lmer(OW_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "MS"))
summary(mix_ms_ow_w)
r.squaredGLMM(mix_ms_ow_w)
anova(mix_ms_ow_w)
eta_squared(anova(mix_ms_ow_w))
```

```{r pairwise-ms-ow-w}
pairwise_ms_ow_w <- lsmeans(mix_ms_ow_w, pairwise ~ level, adjust = "tukey")
pairwise_ms_ow_w$lsmeans |> as_tibble() |> kable()
pairwise_ms_ow_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW_w" & task == "MS") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Memory Span. Overall Workload")
```



### Sternberg Task

#### Reaction time

```{r mix-st-rt}
mix_st_rt <- lmer(rt ~ level + (1|id), ST_data_agg)
summary(mix_st_rt)
r.squaredGLMM(mix_st_rt)
anova(mix_st_rt)
eta_squared(anova(mix_st_rt))
```

```{r pairwise-st-rt}
pairwise_st_rt <- lsmeans(mix_st_rt, pairwise ~ level, adjust = "tukey")
pairwise_st_rt$lsmeans |> as_tibble() |> kable()
pairwise_st_rt$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
ST_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, rt)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Reaction time. Sternberg Task.")
```


#### Accuracy

```{r mix-st-acc}
mix_st_acc <- lmer(acc ~ level + (1|id), ST_data_agg)
summary(mix_st_acc)
r.squaredGLMM(mix_st_acc)
anova(mix_st_acc)
eta_squared(anova(mix_st_acc))
```

```{r pairwise-st-acc}
pairwise_st_acc <- lsmeans(mix_st_acc, pairwise ~ level, adjust = "tukey")
pairwise_st_acc$lsmeans |> as_tibble() |> kable()
pairwise_st_acc$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
ST_data_agg |> 
  mutate(level = factor(level, 
                        ordered = TRUE, 
                        levels = c("easy", "medium", "hard"))) |> 
  ggplot(aes(level, acc)) +
  stat_summary(fun.data = mean_cl_boot, geom = "pointrange") +
  labs(x = "Difficulty Level", y = "Reaction time, s",
       title = "Accuracy. Sternberg Task.")
```



#### ME

##### Raw

```{r mix-st-me}
mix_st_me <- lmer(ME ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_me)
r.squaredGLMM(mix_st_me)
anova(mix_st_me)
eta_squared(anova(mix_st_me))
```

```{r pairwise-st-me}
pairwise_st_me <- lsmeans(mix_st_me, pairwise ~ level, adjust = "tukey")
pairwise_st_me$lsmeans |> as_tibble() |> kable()
pairwise_st_me$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Mental Demand")
```

##### Weighted

```{r mix-st-me-w}
mix_st_me_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_me_w)
r.squaredGLMM(mix_st_me_w)
anova(mix_st_me_w)
eta_squared(anova(mix_st_me_w))
```

```{r pairwise-st-me-w}
pairwise_st_me_w <- lsmeans(mix_st_me_w, pairwise ~ level, adjust = "tukey")
pairwise_st_me_w$lsmeans |> as_tibble() |> kable()
pairwise_st_me_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "ME_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Mental Demand")
```



#### PH

##### Raw

```{r mix-st-ph}
mix_st_ph <- lmer(PH ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_ph)
r.squaredGLMM(mix_st_ph)
anova(mix_st_ph)
eta_squared(anova(mix_st_ph))
```

```{r pairwise-st-ph}
pairwise_st_ph <- lsmeans(mix_st_ph, pairwise ~ level, adjust = "tukey")
pairwise_st_ph$lsmeans |> as_tibble() |> kable()
pairwise_st_ph$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Physical Demand")
```

##### Weighted

```{r mix-st-ph-w}
mix_st_ph_w <- lmer(PH_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_ph_w)
r.squaredGLMM(mix_st_ph_w)
anova(mix_st_ph_w)
eta_squared(anova(mix_st_ph_w))
```

```{r pairwise-st-ph-w}
pairwise_st_ph_w <- lsmeans(mix_st_ph_w, pairwise ~ level, adjust = "tukey")
pairwise_st_ph_w$lsmeans |> as_tibble() |> kable()
pairwise_st_ph_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PH_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Physical Demand")
```



#### TI

##### Raw

```{r mix-st-ti}
mix_st_ti <- lmer(TI ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_ti)
r.squaredGLMM(mix_st_ti)
anova(mix_st_ti)
eta_squared(anova(mix_st_ti))
```

```{r pairwise-st-ti}
pairwise_st_ti <- lsmeans(mix_st_ti, pairwise ~ level, adjust = "tukey")
pairwise_st_ti$lsmeans |> as_tibble() |> kable()
pairwise_st_ti$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Time Pressure")
```

##### Weighted

```{r mix-st-ti-w}
mix_st_ti_w <- lmer(TI_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_ti_w)
r.squaredGLMM(mix_st_ti_w)
anova(mix_st_ti_w)
eta_squared(anova(mix_st_ti_w))
```

```{r pairwise-st-ti-w}
pairwise_st_ti_w <- lsmeans(mix_st_ti_w, pairwise ~ level, adjust = "tukey")
pairwise_st_ti_w$lsmeans |> as_tibble() |> kable()
pairwise_st_ti_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "TI_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Time Pressure")
```




#### PE

##### Raw

```{r mix-st-pe}
mix_st_pe <- lmer(PE ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_pe)
r.squaredGLMM(mix_st_pe)
anova(mix_st_pe)
eta_squared(anova(mix_st_pe))
```

```{r pairwise-st-pe}
pairwise_st_pe <- lsmeans(mix_st_pe, pairwise ~ level, adjust = "tukey")
pairwise_st_pe$lsmeans |> as_tibble() |> kable()
pairwise_st_pe$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Performance")
```

##### Weighted

```{r mix-st-pe-w}
mix_st_pe_w <- lmer(PE_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_pe_w)
r.squaredGLMM(mix_st_pe_w)
anova(mix_st_pe_w)
eta_squared(anova(mix_st_pe_w))
```

```{r pairwise-st-pe-w}
pairwise_st_pe_w <- lsmeans(mix_st_pe_w, pairwise ~ level, adjust = "tukey")
pairwise_st_pe_w$lsmeans |> as_tibble() |> kable()
pairwise_st_pe_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "PE_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Performance")
```



#### EF

##### Raw

```{r mix-st-ef}
mix_st_ef <- lmer(EF ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_ef)
r.squaredGLMM(mix_st_ef)
anova(mix_st_ef)
eta_squared(anova(mix_st_ef))
```

```{r pairwise-st-ef}
pairwise_st_ef <- lsmeans(mix_st_ef, pairwise ~ level, adjust = "tukey")
pairwise_st_ef$lsmeans |> as_tibble() |> kable()
pairwise_st_ef$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Effort")
```

##### Weighted

```{r mix-st-ef-w}
mix_st_ef_w <- lmer(EF_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_ef_w)
r.squaredGLMM(mix_st_ef_w)
anova(mix_st_ef_w)
eta_squared(anova(mix_st_ef_w))
```

```{r pairwise-st-ef-w}
pairwise_st_ef_w <- lsmeans(mix_st_ef_w, pairwise ~ level, adjust = "tukey")
pairwise_st_ef_w$lsmeans |> as_tibble() |> kable()
pairwise_st_ef_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "EF_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Effort")
```


#### FR

##### Raw

```{r mix-st-fr}
mix_st_fr <- lmer(FR ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_fr)
r.squaredGLMM(mix_st_fr)
anova(mix_st_fr)
eta_squared(anova(mix_st_fr))
```

```{r pairwise-st-fr}
pairwise_st_fr <- lsmeans(mix_st_fr, pairwise ~ level, adjust = "tukey")
pairwise_st_fr$lsmeans |> as_tibble() |> kable()
pairwise_st_fr$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Frustration")
```

##### Weighted

```{r mix-st-fr-w}
mix_st_fr_w <- lmer(ME_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_fr_w)
r.squaredGLMM(mix_st_fr_w)
anova(mix_st_fr_w)
eta_squared(anova(mix_st_fr_w))
```

```{r pairwise-st-fr-w}
pairwise_st_fr_w <- lsmeans(mix_st_fr_w, pairwise ~ level, adjust = "tukey")
pairwise_st_fr_w$lsmeans |> as_tibble() |> kable()
pairwise_st_fr_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "FR_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Frustration")
```


#### OW

##### Raw

```{r mix-st-ow}
mix_st_ow <- lmer(OW ~ level + (1|id), nasa_tlx_wide |> filter(task == "ST"))
summary(mix_st_ow)
r.squaredGLMM(mix_st_ow)
anova(mix_st_ow)
eta_squared(anova(mix_st_ow))
```

```{r pairwise-st-ow}
pairwise_st_ow <- lsmeans(mix_st_ow, pairwise ~ level, adjust = "tukey")
pairwise_st_ow$lsmeans |> as_tibble() |> kable()
pairwise_st_ow$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_wide |>
  pivot_longer(cols = c("ME", "PH", "PE", "TI", "EF", "FR", "OW"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (raw)",
       fill = "Difficulty Level",
       title = "Raw Score. Sternberg Task. Overall Workload")
```

##### Weighted

```{r mix-st-ow-w}
mix_st_ow_w <- lmer(OW_w ~ level + (1|id), nasa_tlx_weighted_wide |> filter(task == "ST"))
summary(mix_st_ow_w)
r.squaredGLMM(mix_st_ow_w)
anova(mix_st_ow_w)
eta_squared(anova(mix_st_ow_w))
```

```{r pairwise-st-ow-w}
pairwise_st_ow_w <- lsmeans(mix_st_ow_w, pairwise ~ level, adjust = "tukey")
pairwise_st_ow_w$lsmeans |> as_tibble() |> kable()
pairwise_st_ow_w$contrasts |> as_tibble() |> mutate(sig = ifelse(p.value < .05, "*", "")) |> kable()
```

```{r}
pd <- position_dodge(0.3)
nasa_tlx_weighted_wide |>
  pivot_longer(cols = c("ME_w", "PH_w", "PE_w", "TI_w", "EF_w", "FR_w", "OW_w"),
               names_to = "scale", values_to = "score") |> 
  filter(scale == "OW_w" & task == "ST") |> 
  ggplot(aes(scale, score, color = level)) +
  stat_summary(fun.data = mean_cl_boot, geom = "errorbar",
               position = pd, width = .3) +
  stat_summary(fun = mean, geom = "point",
               position = pd) +
  theme(legend.position = "bottom") +
  scale_color_manual(values = level_colors) +
  labs(x = "NASA-TLX Scale",
       y = "NASA-TLX Score (weighted)",
       fill = "Difficulty Level",
       title = "Weighted Score. Sternberg Task. Overall Workload")
```
